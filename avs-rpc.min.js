!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var m;"undefined"!=typeof window?m=window:"undefined"!=typeof global?m=global:"undefined"!=typeof self&&(m=self);m.avs=t()}}(function(){return function m(q,n,r){function s(h,l){if(!n[h]){if(!q[h]){var k="function"==typeof require&&require;if(!l&&k)return k(h,!0);if(p)return p(h,!0);k=Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",
k;}k=n[h]={exports:{}};q[h][0].call(k.exports,function(c){var a=q[h][1][c];return s(a?a:c)},k,k.exports,m,q,n,r)}return n[h].exports}for(var p="function"==typeof require&&require,l=0;l<r.length;l++)s(r[l]);return s}({1:[function(m,q,n){function r(b,e,d){var f=[],c=[b],k=[b],p=[d?"~":"[Circular]"],u=b,n=1,m;return function(b,g){e&&(g=e.call(this,b,g));""!==b&&(u!==this&&(m=n-a.call(c,this)-1,n-=m,c.splice(n,c.length),f.splice(n-1,f.length),u=this),"object"===typeof g&&g?(n=c.push(u=g),m=a.call(k,g),
0>m?(m=k.push(g)-1,d?(f.push((""+b).replace(v,l)),p[m]="~"+f.join("~")):p[m]=p[0]):g=p[m]):"string"===typeof g&&d&&(g=g.replace(l,h).replace("~",l)));return g}}function s(a){return function(e,d){var f="string"===typeof d;if(f&&"~"===d.charAt(0))return new b(d.slice(1));""===e&&(d=p(d,d,{}));f&&(d=d.replace(c,"~").replace(h,l));return a?a.call(this,e,d):d}}function p(a,e,d){if(e instanceof Array)for(var f=0,c=e.length;f<c;f++)e[f]=p(a,e[f],d);else if(e instanceof b)if(e.length)if(d.hasOwnProperty(e))e=
d[e];else{for(var f=e.split("~"),c=0,h=f.length;c<h;a=a[f[c++].replace(k,"~")]);e=d[e]=a}else e=a;else if(e instanceof Object)for(f in e)e.hasOwnProperty(f)&&(e[f]=p(a,e[f],d));return e}var l="\\x"+("0"+(126).toString(16)).slice(-2),h="\\"+l,v=new RegExp(l,"g"),k=new RegExp(h,"g"),c=new RegExp("(?:^|[^\\\\])"+h),a=[].indexOf||function(a){for(var b=this.length;b--&&this[b]!==a;);return b},b=String;this.stringify=function(a,b,d,f){return JSON.stringify(a,r(a,b,!f),d)};this.parse=function(a,b){return JSON.parse(a,
s(b))}},{}],2:[function(m,q,n){(function(){var r,s,p,l,h=[].slice,q={}.hasOwnProperty,k=function(c,a){function b(){this.constructor=c}for(var g in a)q.call(a,g)&&(c[g]=a[g]);b.prototype=a.prototype;c.prototype=new b;c.__super__=a.prototype;return c};l=m("circular-json");r=function(){return function(c,a,b){this.asynchronous=b;this[a]=function(b){return function(e,d,f){console.log("rpc "+e+": executing local "+a+" - asynchronous: "+b.asynchronous);return c[a].apply(c,h.call(d).concat([f]))}}(this)}}();
s=function(){return function(){var c,a,b,g,e,d,f,k;g=arguments[0];b=2<=arguments.length?h.call(arguments,1):[];c=0;e=(Math.random()+"").substring(2,8);d=function(a){return function(b){return a[b]=function(){var a,d;a=Array.prototype.slice.call(arguments);"function"===typeof a[a.length-1]&&(d=a.pop());if(g)return g._request({method:b,args:a,cb:d,id:""+e+"-"+ ++c})}}}(this);f=0;for(k=b.length;f<k;f++)a=b[f],d(a)}}();n.Rpc=p=function(){function c(){this.locals=[];this.callbacks=[];this._out=function(a){return function(b,
g){return a.log("rpc "+b.id+" error: no rpc out route defined")}}(this)}c.prototype.cbID=0;c.prototype.out=function(a){return this._out=a};c.prototype._request=function(a){var b;a.cb&&"function"===typeof a.cb&&(this.callbacks[b=a.method+(" cb"+this.cbID++)]=a.cb,a.cb=b);b=l.stringify(a);this.log("rpc "+a.id+": out "+b);this._out(a,b);return b};c.prototype._reply=function(a,b){if(a.cb)return this._request({method:a.cb,args:b,id:a.id})};c.prototype._error=function(a,b){if(a.cb)return this._request({method:a.cb,
args:b,err:!0,id:a.id})};c.prototype.process=function(a){var b,g,e,d,f;try{"string"===typeof a?d=l.parse(a):a=l.stringify(d=a);if(d&&d.method){e=this.locals[d.method];this.log("rpc "+d.id+": in  "+a);if(e)return e.asynchronous?e[d.method](d.id,d.args,function(a){return function(b,e){return e?a._error(d,e):a._reply(d,b)}}(this)):this._reply(d,e[d.method](d.id,d.args));if(this.callbacks[d.method])return d.err?g=d.args:f=d.args,this.callbacks[d.method](f,g),delete this.callbacks[d.method];this.log(b=
"error: method "+d.method+" is unknown");return this._error(d,b)}this.log(b="rpc error: message is null");this._error({method:"missing"},b)}catch(c){return this.log(b="error in "+d.method+": "+c),this._error(d,b)}};c.prototype._splat=function(){var a;a=1<=arguments.length?h.call(arguments,0):[];return 1===arguments.length&&"string"!==typeof arguments[0]?arguments[0]:a};c.prototype.remote=function(){var a;a=1<=arguments.length?h.call(arguments,0):[];return function(a,g,e){e.prototype=a.prototype;e=
new e;a=a.apply(e,g);return Object(a)===a?a:e}(s,[this].concat(h.call(this._splat.apply(this,a))),function(){})};c.prototype.implement=function(){var a,b;a=arguments[0];b=2<=arguments.length?h.call(arguments,1):[];return this._expose.apply(this,[a,!1].concat(h.call(this._splat.apply(this,b))))};c.prototype.implementAsync=function(){var a,b;a=arguments[0];b=2<=arguments.length?h.call(arguments,1):[];return this._expose.apply(this,[a,!0].concat(h.call(this._splat.apply(this,b))))};c.prototype._expose=
function(){var a,b,g,e,d,f,c;b=arguments[0];a=arguments[1];e=3<=arguments.length?h.call(arguments,2):[];if(!e.length){for(g in b)"function"===typeof b[g]&&"_"!==g.charAt(0)&&e.push(g);this.log("rpc methods found: "+e)}c=[];d=0;for(f=e.length;d<f;d++)g=e[d],b[g]?(this.locals[g]&&this.log("rpc warning: duplicate method "+g+", now asynchronous: "+a),c.push(this.locals[g]=new r(b,g,a))):c.push(this.log("rpc warning: local object has no method "+g));return c};c.prototype.log=function(a){return console.log(128>
a.length?a:a.substring(0,127)+" ...")};return c}();n.wsRpc=function(c){function a(b){a.__super__.constructor.call(this);b&&b.send&&this.out(function(a,e){return b.send(e,function(a){return function(b){if(b)return a.log(b.toString())}}(this))});this["in"](b)}k(a,c);a.prototype["in"]=function(a){if(a)return a.on?a.on("message",function(a){return function(b,d){if(!d.binary)return a.process(b)}}(this)):a.onmessage=function(a){return function(b){if(b.data.length)return a.process(b.data)}}(this)};return a}(p);
n.angularRpc=function(c){function a(b){a.__super__.constructor.call(this);this.out(function(a,e){return b.post("/rpc",a).success(function(a){return function(b){if(b)return a.process(b)}}(this))})}k(a,c);return a}(p);n.xmlHttpRpc=function(c){function a(b){a.__super__.constructor.call(this);this.out(function(a,e){b.open("POST","/rpc",!0);b.setRequestHeader("Content-type","application/json");b.onload(function(a){return function(){return a.process(b.response)}}(this));return b.send(e)})}k(a,c);return a}(p);
n.ioRpc=function(c){function a(a,c){this.socket=a;this.tag=null!=c?c:"rpc";this.locals=[];if(this.socket)this.socket.on(this.tag,function(a){return function(b,c){return a.process(b,c)}}(this))}k(a,c);a.prototype._request=function(a){var c;this.log("rpc "+a.id+": out "+this.tag+" "+(c=l.stringify(a)));if(this.socket)return this.socket.emit(this.tag,c,function(){if(a.cb)return a.cb.apply(this,arguments)})};a.prototype.process=function(a,c){var e,d,f;f=l.parse(a);this.log("rpc "+f.id+": in  "+this.tag+
" "+a);if(d=this.locals[f.method])try{return e=f.args||[],e.push(function(a){return function(){return c.apply(a,arguments)}}(this)),d.asynchronous?d[f.method](f.id,e):c(d[f.method](f.id,e))}catch(h){return this.log(e="error in "+f.method+": "+h),c(null,e)}else return this.log(e="error: method "+f.method+" is unknown"),c(null,e)};return a}(p)}).call(this)},{"circular-json":1}]},{},[2])(2)});
