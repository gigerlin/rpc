!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var p;"undefined"!=typeof window?p=window:"undefined"!=typeof global?p=global:"undefined"!=typeof self&&(p=self);p.avs=t()}}(function(){return function p(r,q,m){function s(g,l){if(!q[g]){if(!r[g]){var h="function"==typeof require&&require;if(!l&&h)return h(g,!0);if(n)return n(g,!0);h=Error("Cannot find module '"+g+"'");throw h.code="MODULE_NOT_FOUND",
h;}h=q[g]={exports:{}};r[g][0].call(h.exports,function(c){var a=r[g][1][c];return s(a?a:c)},h,h.exports,p,r,q,m)}return q[g].exports}for(var n="function"==typeof require&&require,l=0;l<m.length;l++)s(m[l]);return s}({1:[function(p,r,q){function m(b,e,d){var f=[],c=[b],h=[b],n=[d?"~":"[Circular]"],q=b,p=1,m;return function(b,k){e&&(k=e.call(this,b,k));""!==b&&(q!==this&&(m=p-a.call(c,this)-1,p-=m,c.splice(p,c.length),f.splice(p-1,f.length),q=this),"object"===typeof k&&k?(p=c.push(q=k),m=a.call(h,k),
0>m?(m=h.push(k)-1,d?(f.push((""+b).replace(u,l)),n[m]="~"+f.join("~")):n[m]=n[0]):k=n[m]):"string"===typeof k&&d&&(k=k.replace(l,g).replace("~",l)));return k}}function s(a){return function(e,d){var f="string"===typeof d;if(f&&"~"===d.charAt(0))return new b(d.slice(1));""===e&&(d=n(d,d,{}));f&&(d=d.replace(c,"~").replace(g,l));return a?a.call(this,e,d):d}}function n(a,e,d){if(e instanceof Array)for(var f=0,c=e.length;f<c;f++)e[f]=n(a,e[f],d);else if(e instanceof b)if(e.length)if(d.hasOwnProperty(e))e=
d[e];else{for(var f=e.split("~"),c=0,g=f.length;c<g;a=a[f[c++].replace(h,"~")]);e=d[e]=a}else e=a;else if(e instanceof Object)for(f in e)e.hasOwnProperty(f)&&(e[f]=n(a,e[f],d));return e}var l="\\x"+("0"+(126).toString(16)).slice(-2),g="\\"+l,u=new RegExp(l,"g"),h=new RegExp(g,"g"),c=new RegExp("(?:^|[^\\\\])"+g),a=[].indexOf||function(a){for(var b=this.length;b--&&this[b]!==a;);return b},b=String;this.stringify=function(a,b,d,f){return JSON.stringify(a,m(a,b,!f),d)};this.parse=function(a,b){return JSON.parse(a,
s(b))}},{}],2:[function(p,r,q){(function(){var m,s,n,l,g=[].slice,r={}.hasOwnProperty,h=function(c,a){function b(){this.constructor=c}for(var k in a)r.call(a,k)&&(c[k]=a[k]);b.prototype=a.prototype;c.prototype=new b;c.__super__=a.prototype;return c};l=p("circular-json");m=function(){return function(c,a,b){this.local=c;this.asynchronous=b;this[a]=function(b){return function(e,d,f){var c;console.log("rpc "+e+": executing local "+a+" - asynchronous: "+b.asynchronous);return(c=b.local)[a].apply(c,g.call(d).concat([f]))}}(this)}}();
s=function(){function c(){var a,b,k,e,d,c;k=arguments[0];b=2<=arguments.length?g.call(arguments,1):[];e=function(a){return function(b){return a[b]=function(){var a,d;a=Array.prototype.slice.call(arguments);"function"===typeof a[a.length-1]&&(d=a.pop());if(k)return k._request({method:b,args:a,cb:d,id:""+this.uid+"-"+ ++this.count})}}}(this);d=0;for(c=b.length;d<c;d++)a=b[d],e(a)}c.prototype.count=0;c.prototype.uid=(Math.random()+"").substring(2,8);return c}();q.Rpc=n=function(){function c(){this.locals=
[];this.callbacks=[];this._out=function(a){return function(b,k){return a.log("rpc "+b.id+" error: no rpc out route defined")}}(this)}c.prototype.cbID=0;c.prototype.out=function(a){return this._out=a};c.prototype._request=function(a){var b;a.cb&&"function"===typeof a.cb&&(this.callbacks[b=a.method+(" cb"+this.cbID++)]=a.cb,a.cb=b);b=l.stringify(a);this.log("rpc "+a.id+": out "+b);this._out(a,b);return b};c.prototype._reply=function(a,b){if(a.cb)return this._request({method:a.cb,args:b,id:a.id})};c.prototype._error=
function(a,b){if(a.cb)return this._request({method:a.cb,args:b,err:!0,id:a.id})};c.prototype.process=function(a){var b,k,e,d,c;try{"string"===typeof a?d=l.parse(a):a=l.stringify(d=a);if(d&&d.method){e=this.locals[d.method];this.log("rpc "+d.id+": in  "+a);if(e)return e.asynchronous?e[d.method](d.id,d.args,function(a){return function(b,e){return e?a._error(d,e):a._reply(d,b)}}(this)):this._reply(d,e[d.method](d.id,d.args));if(this.callbacks[d.method])return d.err?k=d.args:c=d.args,this.callbacks[d.method](c,
k),delete this.callbacks[d.method];this.log(b="error: method "+d.method+" is unknown");return this._error(d,b)}this.log(b="rpc error: message is null");this._error({method:"missing"},b)}catch(g){return this.log(b="error in "+d.method+": "+g),this._error(d,b)}};c.prototype._splat=function(){var a;a=1<=arguments.length?g.call(arguments,0):[];return 1===arguments.length&&"string"!==typeof arguments[0]?arguments[0]:a};c.prototype.remote=function(){var a;a=1<=arguments.length?g.call(arguments,0):[];return function(a,
c,e){e.prototype=a.prototype;e=new e;a=a.apply(e,c);return Object(a)===a?a:e}(s,[this].concat(g.call(this._splat.apply(this,a))),function(){})};c.prototype.implement=function(){var a,b;a=arguments[0];b=2<=arguments.length?g.call(arguments,1):[];return this._expose.apply(this,[a,!1].concat(g.call(this._splat.apply(this,b))))};c.prototype.implementAsync=function(){var a,b;a=arguments[0];b=2<=arguments.length?g.call(arguments,1):[];return this._expose.apply(this,[a,!0].concat(g.call(this._splat.apply(this,
b))))};c.prototype._expose=function(){var a,b,c,e,d,f,h;b=arguments[0];a=arguments[1];e=3<=arguments.length?g.call(arguments,2):[];if(!e.length){for(c in b)"function"===typeof b[c]&&"_"!==c.charAt(0)&&e.push(c);this.log("rpc methods found: "+e)}h=[];d=0;for(f=e.length;d<f;d++)c=e[d],b[c]?(this.locals[c]&&this.log("rpc warning: duplicate method "+c+", now asynchronous: "+a),h.push(this.locals[c]=new m(b,c,a))):h.push(this.log("rpc warning: local object has no method "+c));return h};c.prototype.log=
function(a){return console.log(128>a.length?a:a.substring(0,127)+" ...")};return c}();q.wsRpc=function(c){function a(b){a.__super__.constructor.call(this);b&&b.send&&this.out(function(a,e){return b.send(e,function(a){return function(b){if(b)return a.log(b.toString())}}(this))});this["in"](b)}h(a,c);a.prototype["in"]=function(a){if(a)return a.on?a.on("message",function(a){return function(b,d){if(!d.binary)return a.process(b)}}(this)):a.onmessage=function(a){return function(b){if(b.data.length)return a.process(b.data)}}(this)};
return a}(n);q.angularRpc=function(c){function a(b){a.__super__.constructor.call(this);this.out(function(a,c){return b.post("/rpc",a).success(function(a){return function(b){if(b)return a.process(b)}}(this))})}h(a,c);return a}(n);q.xmlHttpRpc=function(c){function a(b){a.__super__.constructor.call(this);this.out(function(a,c){b.open("POST","/rpc",!0);b.setRequestHeader("Content-type","application/json");b.onload(function(a){return function(){return a.process(b.response)}}(this));return b.send(c)})}
h(a,c);return a}(n);q.ioRpc=function(c){function a(a,c){this.socket=a;this.tag=null!=c?c:"rpc";this.locals=[];if(this.socket)this.socket.on(this.tag,function(a){return function(b,c){return a.process(b,c)}}(this))}h(a,c);a.prototype._request=function(a){var c,e;this.log("rpc "+a.id+": out "+this.tag+" "+(e=l.stringify(a)));c=a.cb||function(){};if(this.socket)return this.socket.emit(this.tag,e,function(){return c.apply(this,arguments)})};a.prototype.process=function(a,c){var e,d,f;f=l.parse(a);this.log("rpc "+
f.id+": in  "+this.tag+" "+a);if(d=this.locals[f.method])try{return e=f.args||[],e.push(function(a){return function(){return c.apply(a,arguments)}}(this)),d.asynchronous?d[f.method](f.id,e):c(d[f.method](f.id,e))}catch(g){return c(null,"error in "+f.method+": "+g)}else return c(null,"error: method "+f.method+" is unknown")};return a}(n)}).call(this)},{"circular-json":1}]},{},[2])(2)});
